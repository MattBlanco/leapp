{
 "Transform": "AWS::SecretsManager-2020-07-23",
 "Resources": {
  "DatabaseSecret86DBB7B3": {
   "Type": "AWS::SecretsManager::Secret",
   "Properties": {
    "Description": {
     "Fn::Join": [
      "",
      [
       "Generated by the CDK for stack: ",
       {
        "Ref": "AWS::StackName"
       }
      ]
     ]
    },
    "GenerateSecretString": {
     "ExcludeCharacters": " %+~`#$&*()|[]{}:;<>?!'/@\"\\",
     "GenerateStringKey": "password",
     "PasswordLength": 30,
     "SecretStringTemplate": "{\"username\":\"master\"}"
    },
    "Name": "leapp-plugin-system-database-secret"
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/DatabaseSecret/Resource"
   }
  },
  "DatabaseSecretDatabaseSecretRotationScheduleSecurityGroup67C42F29": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "InfrastructureStack/InfrastructureStack/DatabaseSecret/DatabaseSecretRotationSchedule/SecurityGroup",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "VpcId": "vpc-016d28bcc7f5b6e06"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/DatabaseSecret/DatabaseSecretRotationSchedule/SecurityGroup/Resource"
   }
  },
  "DatabaseSecretDatabaseSecretRotationSchedule23080F45": {
   "Type": "AWS::SecretsManager::RotationSchedule",
   "Properties": {
    "SecretId": {
     "Ref": "DatabaseSecret86DBB7B3"
    },
    "HostedRotationLambda": {
     "ExcludeCharacters": " %+~`#$&*()|[]{}:;<>?!'/@\"\\",
     "RotationLambdaName": "leapp-plugin-system-database-rotate-secret",
     "RotationType": "PostgreSQLSingleUser",
     "VpcSecurityGroupIds": {
      "Fn::GetAtt": [
       "DatabaseSecretDatabaseSecretRotationScheduleSecurityGroup67C42F29",
       "GroupId"
      ]
     },
     "VpcSubnetIds": "subnet-0effa5262519e2005,subnet-023a47cf8214d6756,subnet-065d79422735f8eda"
    },
    "RotationRules": {
     "AutomaticallyAfterDays": 30
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/DatabaseSecret/DatabaseSecretRotationSchedule/Resource"
   }
  },
  "DatabaseSecretPolicy20C1BC95": {
   "Type": "AWS::SecretsManager::ResourcePolicy",
   "Properties": {
    "ResourcePolicy": {
     "Statement": [
      {
       "Action": "secretsmanager:DeleteSecret",
       "Effect": "Deny",
       "Principal": {
        "AWS": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":iam::",
           {
            "Ref": "AWS::AccountId"
           },
           ":root"
          ]
         ]
        }
       },
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "SecretId": {
     "Ref": "DatabaseSecret86DBB7B3"
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/DatabaseSecret/Policy/Resource"
   }
  },
  "DatabaseSecretAttachment9A63A3D4": {
   "Type": "AWS::SecretsManager::SecretTargetAttachment",
   "Properties": {
    "SecretId": {
     "Ref": "DatabaseSecret86DBB7B3"
    },
    "TargetId": {
     "Ref": "RDSCluster423DF6F1"
    },
    "TargetType": "AWS::RDS::DBCluster"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/DatabaseSecret/Attachment/Resource"
   }
  },
  "DatabaseSecurityGroup7319C0F6": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Security group used by Leapp plugin system",
    "GroupName": "leapp-plugin-system-database-sg",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "VpcId": "vpc-016d28bcc7f5b6e06"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/DatabaseSecurityGroup/Resource"
   }
  },
  "RDSClusterSubnets80ABBE08": {
   "Type": "AWS::RDS::DBSubnetGroup",
   "Properties": {
    "DBSubnetGroupDescription": "Subnets for RDSCluster database",
    "SubnetIds": [
     "subnet-0effa5262519e2005",
     "subnet-023a47cf8214d6756",
     "subnet-065d79422735f8eda"
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RDSCluster/Subnets/Default"
   }
  },
  "RDSCluster423DF6F1": {
   "Type": "AWS::RDS::DBCluster",
   "Properties": {
    "Engine": "aurora-postgresql",
    "DBClusterIdentifier": "leapp-plugin-system-cluster",
    "DBClusterParameterGroupName": "default.aurora-postgresql10",
    "DBSubnetGroupName": {
     "Ref": "RDSClusterSubnets80ABBE08"
    },
    "EnableHttpEndpoint": true,
    "EngineMode": "serverless",
    "MasterUsername": {
     "Fn::Join": [
      "",
      [
       "{{resolve:secretsmanager:",
       {
        "Ref": "DatabaseSecret86DBB7B3"
       },
       ":SecretString:username::}}"
      ]
     ]
    },
    "MasterUserPassword": {
     "Fn::Join": [
      "",
      [
       "{{resolve:secretsmanager:",
       {
        "Ref": "DatabaseSecret86DBB7B3"
       },
       ":SecretString:password::}}"
      ]
     ]
    },
    "ScalingConfiguration": {
     "AutoPause": false,
     "MaxCapacity": 2,
     "MinCapacity": 2
    },
    "StorageEncrypted": true,
    "VpcSecurityGroupIds": [
     {
      "Fn::GetAtt": [
       "DatabaseSecurityGroup7319C0F6",
       "GroupId"
      ]
     }
    ]
   },
   "UpdateReplacePolicy": "Snapshot",
   "DeletionPolicy": "Snapshot",
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RDSCluster/Resource"
   }
  },
  "LeappPluginLayer77551666": {
   "Type": "AWS::Lambda::LayerVersion",
   "Properties": {
    "Content": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "955c03551367f5e7d20ca5baee6dcb3e69eb9da3b731dfa8d15e58caebd788ff.zip"
    },
    "CompatibleRuntimes": [
     "nodejs14.x"
    ],
    "LayerName": "dev-leapp-plugin-system-layer"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginLayer/Resource",
    "aws:asset:path": "asset.955c03551367f5e7d20ca5baee6dcb3e69eb9da3b731dfa8d15e58caebd788ff.zip",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Content"
   }
  },
  "LeappPluginSystemFunctionServiceRole94D9E5B9": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginSystemFunction/ServiceRole/Resource"
   }
  },
  "LeappPluginSystemFunctionServiceRoleDefaultPolicyE86C15B1": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "rds-data:BatchExecuteStatement",
        "rds-data:BeginTransaction",
        "rds-data:CommitTransaction",
        "rds-data:ExecuteStatement",
        "rds-data:RollbackTransaction"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue"
       ],
       "Effect": "Allow",
       "Resource": {
        "Ref": "DatabaseSecretAttachment9A63A3D4"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "LeappPluginSystemFunctionServiceRoleDefaultPolicyE86C15B1",
    "Roles": [
     {
      "Ref": "LeappPluginSystemFunctionServiceRole94D9E5B9"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginSystemFunction/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "LeappPluginSystemFunctionE6D10594": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "a26900e52c08685fce6fff80dcf8d8cfc50c24e9808c6777f06556b26e0d11e9.zip"
    },
    "Role": {
     "Fn::GetAtt": [
      "LeappPluginSystemFunctionServiceRole94D9E5B9",
      "Arn"
     ]
    },
    "Environment": {
     "Variables": {
      "RDS_ARN": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":rds:",
         {
          "Ref": "AWS::Region"
         },
         ":",
         {
          "Ref": "AWS::AccountId"
         },
         ":cluster:",
         {
          "Ref": "RDSCluster423DF6F1"
         }
        ]
       ]
      },
      "RDS_SECRET_ARN": {
       "Ref": "DatabaseSecret86DBB7B3"
      },
      "RDS_DATABASE": "postgres"
     }
    },
    "FunctionName": "dev-leapp-plugin-system-function",
    "Handler": "app.handler",
    "Layers": [
     {
      "Ref": "LeappPluginLayer77551666"
     }
    ],
    "Runtime": "nodejs14.x",
    "Timeout": 10
   },
   "DependsOn": [
    "LeappPluginSystemFunctionServiceRoleDefaultPolicyE86C15B1",
    "LeappPluginSystemFunctionServiceRole94D9E5B9"
   ],
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginSystemFunction/Resource",
    "aws:asset:path": "asset.a26900e52c08685fce6fff80dcf8d8cfc50c24e9808c6777f06556b26e0d11e9",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "LeappPluginSystemFunctionApiPermissionsE51AEBD9": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "LeappPluginSystemFunctionE6D10594",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":execute-api:",
       {
        "Ref": "AWS::Region"
       },
       ":",
       {
        "Ref": "AWS::AccountId"
       },
       ":",
       {
        "Ref": "RestApi0C43BF4B"
       },
       "/*/*/*"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginSystemFunction/ApiPermissions"
   }
  },
  "RestApi0C43BF4B": {
   "Type": "AWS::ApiGateway::RestApi",
   "Properties": {
    "Description": "dev-leapp-plugin-system-api",
    "Name": "dev-leapp-plugin-system-api"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Resource"
   }
  },
  "RestApiCloudWatchRoleE3ED6605": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "apigateway.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/CloudWatchRole/Resource"
   }
  },
  "RestApiAccount7C83CF5A": {
   "Type": "AWS::ApiGateway::Account",
   "Properties": {
    "CloudWatchRoleArn": {
     "Fn::GetAtt": [
      "RestApiCloudWatchRoleE3ED6605",
      "Arn"
     ]
    }
   },
   "DependsOn": [
    "RestApi0C43BF4B"
   ],
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Account"
   }
  },
  "RestApiDeployment180EC503eb39f087212f51d8c9bdbbddd8e17ce8": {
   "Type": "AWS::ApiGateway::Deployment",
   "Properties": {
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    },
    "Description": "Automatically created by the RestApi construct"
   },
   "DependsOn": [
    "RestApiapiC55947A1",
    "RestApiapiv1pluginspluginIdget12F0C377",
    "RestApiapiv1pluginspluginIdputFED004FF",
    "RestApiapiv1pluginspluginIdD99106D3",
    "RestApiapiv1pluginsget5276E417",
    "RestApiapiv1pluginspostE867B99A",
    "RestApiapiv1pluginsA8695F04",
    "RestApiapiv1B3578DAE"
   ],
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Deployment/Resource"
   }
  },
  "RestApiDeploymentStageapi14DA8585": {
   "Type": "AWS::ApiGateway::Stage",
   "Properties": {
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    },
    "DeploymentId": {
     "Ref": "RestApiDeployment180EC503eb39f087212f51d8c9bdbbddd8e17ce8"
    },
    "StageName": "api"
   },
   "DependsOn": [
    "RestApiAccount7C83CF5A"
   ],
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/DeploymentStage.api/Resource"
   }
  },
  "RestApiapiC55947A1": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Fn::GetAtt": [
      "RestApi0C43BF4B",
      "RootResourceId"
     ]
    },
    "PathPart": "api",
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/Resource"
   }
  },
  "RestApiapiv1B3578DAE": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Ref": "RestApiapiC55947A1"
    },
    "PathPart": "v1",
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/v1/Resource"
   }
  },
  "RestApiapiv1pluginsA8695F04": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Ref": "RestApiapiv1B3578DAE"
    },
    "PathPart": "plugins",
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/v1/plugins/Resource"
   }
  },
  "RestApiapiv1pluginsget5276E417": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "HttpMethod": "GET",
    "ResourceId": {
     "Ref": "RestApiapiv1pluginsA8695F04"
    },
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    },
    "AuthorizationType": "NONE",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":apigateway:",
        {
         "Ref": "AWS::Region"
        },
        ":lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "LeappPluginSystemFunctionE6D10594",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/v1/plugins/get/Resource"
   }
  },
  "RestApiapiv1pluginspostE867B99A": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "HttpMethod": "POST",
    "ResourceId": {
     "Ref": "RestApiapiv1pluginsA8695F04"
    },
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    },
    "AuthorizationType": "NONE",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":apigateway:",
        {
         "Ref": "AWS::Region"
        },
        ":lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "LeappPluginSystemFunctionE6D10594",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/v1/plugins/post/Resource"
   }
  },
  "RestApiapiv1pluginspluginIdD99106D3": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Ref": "RestApiapiv1pluginsA8695F04"
    },
    "PathPart": "{pluginId}",
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/v1/plugins/{pluginId}/Resource"
   }
  },
  "RestApiapiv1pluginspluginIdget12F0C377": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "HttpMethod": "GET",
    "ResourceId": {
     "Ref": "RestApiapiv1pluginspluginIdD99106D3"
    },
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    },
    "AuthorizationType": "NONE",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":apigateway:",
        {
         "Ref": "AWS::Region"
        },
        ":lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "LeappPluginSystemFunctionE6D10594",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/v1/plugins/{pluginId}/get/Resource"
   }
  },
  "RestApiapiv1pluginspluginIdputFED004FF": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "HttpMethod": "PUT",
    "ResourceId": {
     "Ref": "RestApiapiv1pluginspluginIdD99106D3"
    },
    "RestApiId": {
     "Ref": "RestApi0C43BF4B"
    },
    "AuthorizationType": "NONE",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":apigateway:",
        {
         "Ref": "AWS::Region"
        },
        ":lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "LeappPluginSystemFunctionE6D10594",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/RestApi/Default/api/v1/plugins/{pluginId}/put/Resource"
   }
  },
  "LeappPluginUpdaterLayer4B6A6321": {
   "Type": "AWS::Lambda::LayerVersion",
   "Properties": {
    "Content": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "126221d9772a15f7e1a7510e2bdc288def8709b1ac07556236289b006a3fe489.zip"
    },
    "CompatibleRuntimes": [
     "nodejs14.x"
    ],
    "LayerName": "dev-leapp-plugin-updater-layer"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginUpdaterLayer/Resource",
    "aws:asset:path": "asset.126221d9772a15f7e1a7510e2bdc288def8709b1ac07556236289b006a3fe489.zip",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Content"
   }
  },
  "LeappPluginUpdaterFunctionServiceRoleFBFD1563": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginUpdaterFunction/ServiceRole/Resource"
   }
  },
  "LeappPluginUpdaterFunctionServiceRoleDefaultPolicyD4DD496A": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "sqs:GetQueueAttributes",
        "sqs:GetQueueUrl",
        "sqs:SendMessage"
       ],
       "Effect": "Allow",
       "Resource": "arn:aws:sqs:eu-west-1:198460698501:sign-queue"
      },
      {
       "Action": [
        "rds-data:BatchExecuteStatement",
        "rds-data:BeginTransaction",
        "rds-data:CommitTransaction",
        "rds-data:ExecuteStatement",
        "rds-data:RollbackTransaction"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue"
       ],
       "Effect": "Allow",
       "Resource": {
        "Ref": "DatabaseSecretAttachment9A63A3D4"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "LeappPluginUpdaterFunctionServiceRoleDefaultPolicyD4DD496A",
    "Roles": [
     {
      "Ref": "LeappPluginUpdaterFunctionServiceRoleFBFD1563"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginUpdaterFunction/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "LeappPluginUpdaterFunction888D3D22": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "9c0a04d64efde45e434139fff723ddc6c1edaf66d95dd19ec3657455f27d9da5.zip"
    },
    "Role": {
     "Fn::GetAtt": [
      "LeappPluginUpdaterFunctionServiceRoleFBFD1563",
      "Arn"
     ]
    },
    "Environment": {
     "Variables": {
      "RDS_ARN": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":rds:",
         {
          "Ref": "AWS::Region"
         },
         ":",
         {
          "Ref": "AWS::AccountId"
         },
         ":cluster:",
         {
          "Ref": "RDSCluster423DF6F1"
         }
        ]
       ]
      },
      "RDS_SECRET_ARN": {
       "Ref": "DatabaseSecret86DBB7B3"
      },
      "RDS_DATABASE": "postgres",
      "QUEUE_URL": "https://sqs.eu-west-1.amazonaws.com/198460698501/sign-queue"
     }
    },
    "FunctionName": "dev-leapp-plugin-updater-function",
    "Handler": "app.handler",
    "Layers": [
     {
      "Ref": "LeappPluginUpdaterLayer4B6A6321"
     }
    ],
    "Runtime": "nodejs14.x",
    "Timeout": 30
   },
   "DependsOn": [
    "LeappPluginUpdaterFunctionServiceRoleDefaultPolicyD4DD496A",
    "LeappPluginUpdaterFunctionServiceRoleFBFD1563"
   ],
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginUpdaterFunction/Resource",
    "aws:asset:path": "asset.9c0a04d64efde45e434139fff723ddc6c1edaf66d95dd19ec3657455f27d9da5",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "UpdateRule5163DF91": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "Description": "dev-plugin-system-update",
    "Name": "dev-plugin-system-update",
    "ScheduleExpression": "rate(1 day)",
    "State": "ENABLED",
    "Targets": [
     {
      "Arn": {
       "Fn::GetAtt": [
        "LeappPluginUpdaterFunction888D3D22",
        "Arn"
       ]
      },
      "Id": "Target0"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/UpdateRule/Resource"
   }
  },
  "UpdateRuleAllowEventRuleInfrastructureStackLeappPluginUpdaterFunction8FCACFF1BA7A5950": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "LeappPluginUpdaterFunction888D3D22",
      "Arn"
     ]
    },
    "Principal": "events.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "UpdateRule5163DF91",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/UpdateRule/AllowEventRuleInfrastructureStackLeappPluginUpdaterFunction8FCACFF1"
   }
  },
  "LeappPluginSignatureUpdaterLayerB4BAFD8C": {
   "Type": "AWS::Lambda::LayerVersion",
   "Properties": {
    "Content": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "22e6142cb278c077d4fd4ee9a29a8d7ad471190ee29de8addc7c6ba6c54d3f54.zip"
    },
    "CompatibleRuntimes": [
     "nodejs14.x"
    ],
    "LayerName": "dev-leapp-plugin-signature-updater-layer"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginSignatureUpdaterLayer/Resource",
    "aws:asset:path": "asset.22e6142cb278c077d4fd4ee9a29a8d7ad471190ee29de8addc7c6ba6c54d3f54.zip",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Content"
   }
  },
  "LeappSignatureUpdaterFunctionServiceRole7EFB31FD": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappSignatureUpdaterFunction/ServiceRole/Resource"
   }
  },
  "LeappSignatureUpdaterFunctionServiceRoleDefaultPolicy73AD3C34": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "rds-data:BatchExecuteStatement",
        "rds-data:BeginTransaction",
        "rds-data:CommitTransaction",
        "rds-data:ExecuteStatement",
        "rds-data:RollbackTransaction"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue"
       ],
       "Effect": "Allow",
       "Resource": {
        "Ref": "DatabaseSecretAttachment9A63A3D4"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "LeappSignatureUpdaterFunctionServiceRoleDefaultPolicy73AD3C34",
    "Roles": [
     {
      "Ref": "LeappSignatureUpdaterFunctionServiceRole7EFB31FD"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappSignatureUpdaterFunction/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "LeappSignatureUpdaterFunctionEC6BB048": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "006bda58881c190877bb23ea1204f4c81269faa5141c5ed0f8bc1f8131732e72.zip"
    },
    "Role": {
     "Fn::GetAtt": [
      "LeappSignatureUpdaterFunctionServiceRole7EFB31FD",
      "Arn"
     ]
    },
    "Environment": {
     "Variables": {
      "RDS_ARN": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":rds:",
         {
          "Ref": "AWS::Region"
         },
         ":",
         {
          "Ref": "AWS::AccountId"
         },
         ":cluster:",
         {
          "Ref": "RDSCluster423DF6F1"
         }
        ]
       ]
      },
      "RDS_SECRET_ARN": {
       "Ref": "DatabaseSecret86DBB7B3"
      },
      "RDS_DATABASE": "postgres"
     }
    },
    "FunctionName": "dev-leapp-signature-updater-function",
    "Handler": "app.handler",
    "Layers": [
     {
      "Ref": "LeappPluginSignatureUpdaterLayerB4BAFD8C"
     }
    ],
    "Runtime": "nodejs14.x",
    "Timeout": 30
   },
   "DependsOn": [
    "LeappSignatureUpdaterFunctionServiceRoleDefaultPolicy73AD3C34",
    "LeappSignatureUpdaterFunctionServiceRole7EFB31FD"
   ],
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappSignatureUpdaterFunction/Resource",
    "aws:asset:path": "asset.006bda58881c190877bb23ea1204f4c81269faa5141c5ed0f8bc1f8131732e72",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "LeappPluginSignerStarterLayer9D5A60FF": {
   "Type": "AWS::Lambda::LayerVersion",
   "Properties": {
    "Content": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "00269566901ecb64cb7b2361815da145b66c545b8a7223372d7be9af811ec63b.zip"
    },
    "CompatibleRuntimes": [
     "nodejs14.x"
    ],
    "LayerName": "dev-leapp-plugin-signer-starter-layer"
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappPluginSignerStarterLayer/Resource",
    "aws:asset:path": "asset.00269566901ecb64cb7b2361815da145b66c545b8a7223372d7be9af811ec63b.zip",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Content"
   }
  },
  "LeappSignerStarterFunctionServiceRole39E4000C": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappSignerStarterFunction/ServiceRole/Resource"
   }
  },
  "LeappSignerStarterFunction91F1E2D4": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
     },
     "S3Key": "a55d12405f9bd0e511ff61d8274253e62519620b3f8069274f65ad20006450df.zip"
    },
    "Role": {
     "Fn::GetAtt": [
      "LeappSignerStarterFunctionServiceRole39E4000C",
      "Arn"
     ]
    },
    "Environment": {
     "Variables": {
      "RDS_ARN": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":rds:",
         {
          "Ref": "AWS::Region"
         },
         ":",
         {
          "Ref": "AWS::AccountId"
         },
         ":cluster:",
         {
          "Ref": "RDSCluster423DF6F1"
         }
        ]
       ]
      },
      "RDS_SECRET_ARN": {
       "Ref": "DatabaseSecret86DBB7B3"
      },
      "RDS_DATABASE": "postgres"
     }
    },
    "FunctionName": "dev-leapp-signer-starter-function",
    "Handler": "app.handler",
    "Layers": [
     {
      "Ref": "LeappPluginSignerStarterLayer9D5A60FF"
     }
    ],
    "Runtime": "nodejs14.x",
    "Timeout": 30
   },
   "DependsOn": [
    "LeappSignerStarterFunctionServiceRole39E4000C"
   ],
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/LeappSignerStarterFunction/Resource",
    "aws:asset:path": "asset.a55d12405f9bd0e511ff61d8274253e62519620b3f8069274f65ad20006450df",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/2VSyXLCMAz9lt6N28KhvbJMe+lCk06vjHDUYEjs1JZhMpn8e+WEUCgnPS2W9J41lpN7eXcDBz9S2W5U6LVs3tATZimB2okEvQ1OoeCKVeMyL5sFEKzBY4rKIYkU3R5dgd7Pi8APnUjD2iA9OxsqMf82i9lV4FjZCt/18CUYyNHJhrPHtoklIG1NqjaYhQLjw6vYsN3SFlrVXcllpG/2CS5HmhIz2pRoSJzG/M+0AtVYNpwMTlN9Wvki0IoCynUGsnmBGt0XOs9LxbIL/ykYRcfEOV6iK7WPJcx/sgLvWQE5jYZ9OQtqhzRjgYWGUjaJHciz/SPao1ZApXMgPEAd14lrsQQ0rfRRjQFOlbKBqS+wKmw9qHDm8X/n3aAeDEJ2i5yu4Exh8Yq0sVkM9YjZ/Hj5ETD0j3DPbflekuH32Lat6IjGGdrkMfweqAp00Znx3JpMU6eRsRnKrb/d3z/IR77Vrdd65JiLLlEmvf0FPH8/4ccCAAA="
   },
   "Metadata": {
    "aws:cdk:path": "InfrastructureStack/InfrastructureStack/CDKMetadata/Default"
   },
   "Condition": "CDKMetadataAvailable"
  }
 },
 "Outputs": {
  "RestApiEndpoint0551178A": {
   "Value": {
    "Fn::Join": [
     "",
     [
      "https://",
      {
       "Ref": "RestApi0C43BF4B"
      },
      ".execute-api.",
      {
       "Ref": "AWS::Region"
      },
      ".",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "RestApiDeploymentStageapi14DA8585"
      },
      "/"
     ]
    ]
   }
  }
 },
 "Conditions": {
  "CDKMetadataAvailable": {
   "Fn::Or": [
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "af-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ca-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-northwest-1"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-3"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "me-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "sa-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-2"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-west-2"
       ]
      }
     ]
    }
   ]
  }
 }
}